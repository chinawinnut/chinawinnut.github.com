

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>问题排查 &mdash; WingNut 1.0 文档</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="索引"
              href="genindex.html"/>
        <link rel="search" title="搜索" href="search.html"/>
    <link rel="top" title="WingNut 1.0 文档" href="index.html"/>
        <link rel="next" title="gdb与dbx使用简介" href="gdbAnddbx.html"/>
        <link rel="prev" title="工具推荐" href="tools.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> WingNut
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="cplusplus.html">C和C++复习</a></li>
<li class="toctree-l1"><a class="reference internal" href="mysql.html">mysql使用手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="eclipse.html">eclipse使用手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">工具推荐</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">问题排查</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#baf">相关baf调不到：</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">编写代码注意:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">表不存在</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id4">入参接收说明</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id5">报错以提示代码所在</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id6">baf串有没有拼错</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id7">产品订购变更</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id8">以下是给后台开发的</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id9">网络方面的问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="#shell">shell脚本的问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="#core12">core的原因1、2</a></li>
<li class="toctree-l2"><a class="reference internal" href="#core3456">core的原因3、4、5、6</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gdbAnddbx.html">gdb与dbx使用简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="myinstall.html">一些软件的安装与使用</a></li>
<li class="toctree-l1"><a class="reference internal" href="linux-unix-command.html">linux/unix 命令</a></li>
<li class="toctree-l1"><a class="reference internal" href="collections.html">我收藏的一些技术网站</a></li>
<li class="toctree-l1"><a class="reference internal" href="forums.html">一些技术论坛</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">WingNut</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>问题排查</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/problems.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>问题排查<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<p><strong>可以自己先查一下</strong></p>
<div class="section" id="baf">
<h2>相关baf调不到：<a class="headerlink" href="#baf" title="永久链接至标题">¶</a></h2>
<blockquote>
<div>可能在相关tcl文件中没有加载新增的库(如果新的baf在新增加的库中)，解决办法是bms.tcl，acct.tcl，unif_bms.tcl中加上加载新库的语句，不要漏掉主机。</div></blockquote>
</div>
<div class="section" id="id2">
<h2>编写代码注意:<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<blockquote>
<div><p>千万不要在反斜杠接下来一行写代码。主要针对这种写法</p>
<p>//some comments。\</p>
<p>int a;</p>
<p>实际编译的时候会把int a给注释掉的。</p>
</div></blockquote>
</div>
<div class="section" id="id3">
<h2>表不存在<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<p>把Bms_Action_Batch里面的baf拿出来拼成下面的串，单个在后台跑。然后看屏幕输出，或后
台日志（bms.log或acct.log）,这次的例子正好就可以如此解决:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Fee_Einvoice_Print_Receipt {COMM_INFO {BUSI_CODE 120150} {REGION_ID A} {COUNTY_ID A00} {OFFICE_ID J01} {OPERATOR_ID AIQA27} {CHANNEL A2} {OP_MODE SUBMIT} {FIRST_DEV_OPER J01} {SECOND_DEV_OPER AIQA27} {SYSTEM BSS}} {{PRINT_FLAG 1} {KPXT 01} {GMF_MC 张森淼} {FYZE 40.00} {OTHER_INFO 账户编号：301790170|账期：201608|账单总费用：40.00|应付金额：40.0} {REGION_ID A} {FEE_LIST {{通信服务费 40.00}}} {BUSI_CODE 120150} {SERVICE_NUM {18601721776 }} {SUBSCRIPTION_ID 301866008} {ACCOUNT_ID 301790170}}
New_accPrintLog {COMM_INFO {BUSI_CODE 120150} {REGION_ID A} {COUNTY_ID A00} {OFFICE_ID J01} {OPERATOR_ID AIQA27} {CHANNEL A2} {OP_MODE SUBMIT} {FIRST_DEV_OPER J01} {SECOND_DEV_OPER AIQA27} {SYSTEM BSS}} {{BILL_TYPE 1} {PRINT_MODE 1} {TIMES_ADD 1} {PRINT_LOG_LIST { {  {} 72099957 {}  {} 301790170 20170301 201609 3697239708 40000 50 {}  0 {}  300000644 1 A  {}  {}  {}  {}  } }}}
</pre></div>
</div>
<p>后台跑串方法，35主机，进etc目录，输入tclsh，输入营业：source bms.tcl（或账管acct.tcl），
将上面的串贴进去，跑一下，看屏幕报什么错，如果没法确定，再去log目录下找后台日志看一下。这次报错我在后台找到这些，是New_accPrintLog报的。
错误日志:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Mar</span>  <span class="mi">2</span> <span class="mi">09</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mf">38.096</span> <span class="mi">2017</span><span class="o">@&lt;</span><span class="n">local_host</span><span class="o">&gt;</span><span class="nd">@4325508@LM_ERROR@BMS</span><span class="o">|</span><span class="p">[</span><span class="n">BILLMGR</span><span class="o">-</span><span class="mi">1003</span><span class="p">]</span> <span class="n">AIDB</span> <span class="n">SQLException</span><span class="p">:</span> <span class="n">OracleError</span><span class="p">::</span><span class="mi">942</span> <span class="o">-</span> <span class="n">ORA</span><span class="o">-</span><span class="mi">00942</span><span class="p">:</span> <span class="o">**</span><span class="n">table</span> <span class="ow">or</span> <span class="n">view</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span><span class="o">**</span>
<span class="n">SQL</span><span class="p">:</span> <span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">ACC_PRINT_LOG_201703</span> <span class="p">(</span> <span class="n">SERIAL_CODE</span><span class="p">,</span><span class="n">SUBSCRIPTION_ID</span><span class="p">,</span><span class="n">BATCH_CODE</span><span class="p">,</span><span class="n">PAY_SERIAL_CODE</span><span class="p">,</span><span class="n">BUSINESS_CODE</span><span class="p">,</span><span class="n">ACCOUNT_ID</span><span class="p">,</span><span class="n">VALUE_DATE</span><span class="p">,</span><span class="n">CYCLE_MONTH</span><span class="p">,</span><span class="n">INVOICE_SEQ</span><span class="p">,</span><span class="n">AGAINST_FUND_AMOUNT</span><span class="p">,</span><span class="n">TOTAL_AMOUNT</span><span class="p">,</span><span class="n">BILL_TEMPLATE_ID</span><span class="p">,</span><span class="n">INVOICE_NO</span><span class="p">,</span><span class="n">STATUS</span><span class="p">,</span><span class="n">LAST_STATUS_DATE</span><span class="p">,</span><span class="n">CUSTOMER_ID</span><span class="p">,</span><span class="n">CUSTOMER_TYPE</span><span class="p">,</span><span class="n">REGION_ID</span><span class="p">,</span><span class="n">OPERATOR_ID</span><span class="p">,</span><span class="n">OFFICE_ID</span><span class="p">,</span><span class="n">CREATE_TIME</span><span class="p">,</span><span class="n">REMARK</span><span class="p">,</span><span class="n">CHANNEL_ID</span><span class="p">,</span><span class="n">KEY_SOURCE_TYPE_CD</span><span class="p">,</span><span class="n">bill_type</span><span class="p">,</span><span class="n">print_mode</span><span class="p">,</span><span class="n">times_add</span> <span class="p">)</span>  <span class="n">VALUES</span> <span class="p">(</span> <span class="p">:</span><span class="n">f1</span><span class="p">,:</span><span class="n">f2</span><span class="p">,:</span><span class="n">f3</span><span class="p">,:</span><span class="n">f4</span><span class="p">,:</span><span class="n">f5</span><span class="p">,:</span><span class="n">f6</span><span class="p">,:</span><span class="n">f7</span><span class="p">,:</span><span class="n">f8</span><span class="p">,:</span><span class="n">f9</span><span class="p">,:</span><span class="n">f10</span><span class="p">,:</span><span class="n">f11</span><span class="p">,:</span><span class="n">f12</span><span class="p">,:</span><span class="n">f13</span><span class="p">,:</span><span class="n">f14</span><span class="p">,:</span><span class="n">f15</span><span class="p">,:</span><span class="n">f16</span><span class="p">,:</span><span class="n">f17</span><span class="p">,:</span><span class="n">f18</span><span class="p">,:</span><span class="n">f19</span><span class="p">,:</span><span class="n">f20</span><span class="p">,:</span><span class="n">f21</span><span class="p">,:</span><span class="n">f22</span><span class="p">,:</span><span class="n">f23</span><span class="p">,:</span><span class="n">f24</span><span class="p">,:</span><span class="n">f25</span><span class="p">,:</span><span class="n">f26</span><span class="p">,:</span><span class="n">f27</span> <span class="p">)</span>
<span class="n">Mar</span>  <span class="mi">2</span> <span class="mi">09</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mf">38.096</span> <span class="mi">2017</span><span class="o">@&lt;</span><span class="n">local_host</span><span class="o">&gt;</span><span class="nd">@4325508@LM_DEBUG@BMS</span><span class="o">|</span><span class="p">[</span><span class="n">TIMER_INFO</span><span class="p">]</span> <span class="p">(</span><span class="n">execute</span><span class="p">)</span> <span class="n">done</span><span class="p">,</span> <span class="n">time_used</span> <span class="o">=</span> <span class="mf">0.292296</span> <span class="o">.........</span>
<span class="n">Mar</span>  <span class="mi">2</span> <span class="mi">09</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mf">38.097</span> <span class="mi">2017</span><span class="o">@&lt;</span><span class="n">local_host</span><span class="o">&gt;</span><span class="nd">@4325508@LM_ERROR@BMS</span><span class="o">|</span><span class="n">BMS</span><span class="o">-</span><span class="mi">2002</span> <span class="n">BMS异常</span> <span class="n">ACC_PRINT_LOG_201703</span><span class="p">:</span><span class="n">insert错误</span>
<span class="n">File</span><span class="p">:</span> <span class="n">accBillManage</span><span class="o">.</span><span class="n">cpp</span><span class="p">,</span> <span class="n">Line</span><span class="c1">#: 8768, Compiled DateTime: 17:24:59 Jan 11 2017</span>
<span class="n">Mar</span>  <span class="mi">2</span> <span class="mi">09</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mf">38.097</span> <span class="mi">2017</span><span class="o">@&lt;</span><span class="n">local_host</span><span class="o">&gt;</span><span class="nd">@4325508@LM_DEBUG@BMS</span><span class="o">|</span><span class="n">Performing</span> <span class="n">Transaction</span> <span class="n">ROLLBACK</span><span class="o">...</span>
<span class="n">Mar</span>  <span class="mi">2</span> <span class="mi">09</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mf">38.098</span> <span class="mi">2017</span><span class="o">@&lt;</span><span class="n">local_host</span><span class="o">&gt;</span><span class="nd">@4325508@LM_INFO@BMS</span><span class="o">|</span><span class="n">BMS</span><span class="o">-</span><span class="mi">1002</span> <span class="n">事务出口</span> <span class="n">New_accPrintLog</span>
<span class="n">Mar</span>  <span class="mi">2</span> <span class="mi">09</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mf">42.230</span> <span class="mi">2017</span><span class="o">@&lt;</span><span class="n">local_host</span><span class="o">&gt;</span><span class="nd">@4325508@LM_INFO@BMS</span><span class="o">|</span><span class="p">[</span><span class="n">BMS</span><span class="p">]</span> <span class="n">停止于Thu</span> <span class="n">Mar</span>  <span class="mi">2</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mf">42.230918</span>
</pre></div>
</div>
<p>这句告诉我们表不存在:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">AIDB</span> <span class="n">SQLException</span><span class="p">:</span> <span class="n">OracleError</span><span class="p">::</span><span class="mi">942</span> <span class="o">-</span> <span class="n">ORA</span><span class="o">-</span><span class="mi">00942</span><span class="p">:</span> <span class="n">table</span> <span class="ow">or</span> <span class="n">view</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span>
</pre></div>
</div>
<p>到plsql找，营业库发现没有ACC_PRINT_LOG_201703，但有ACC_PRINT_LOG_201702，再到账务库，发现ACC_PRINT_LOG_201703是有的，说明这张表没建同义词。
问题找到了，在营业建一下这张表的同义词就可以了。</p>
</div>
<div class="section" id="id4">
<h2>入参接收说明<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h2>
<p>通常老的baf不会有什么问题（只有新开发时除外），遇到的基本上是表或者入参的问题。
这时如果有需求的开发文档，看一下对baf的出入参要求，没有的话，如果后台忙没空帮
你看，你可以取35主机的src目录找到baf源码，看一下里面的出入参要求:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>BMS_DEF_INT，BMS_DEF_STR  通常外部不传会有默认值
BMS_DEF_INT2，BMS_DEF_STR2 通常外部不传会有默认值，也可以接收上一个baf的出参
BMS_REQUIRE_DOUBLE2             必传，或从上个baf获取参数
BMS_REQUIRE_DOUBLE      必传
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h2>报错以提示代码所在<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h2>
<p>另外，报错处File: accBillManage.cpp, Line#: 8768, 这种的，可以到代码处看看，可能很明显就看出问题所在了。
先切到bms或acc目录，不行切到src，再搜索代码的语句是:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">find</span> <span class="o">.</span> <span class="o">-</span><span class="n">name</span> <span class="s2">&quot;*.cc&quot;</span><span class="o">|</span><span class="n">xargs</span> <span class="n">grep</span> <span class="o">-</span><span class="n">rn</span> <span class="s2">&quot;xxxx&quot;</span>
<span class="n">find</span> <span class="o">.</span> <span class="o">-</span><span class="n">name</span> <span class="s2">&quot;*.cpp&quot;</span><span class="o">|</span><span class="n">xargs</span> <span class="n">grep</span> <span class="o">-</span><span class="n">rn</span> <span class="s2">&quot;xxxx&quot;</span>
<span class="n">find</span> <span class="o">.</span> <span class="o">-</span><span class="n">name</span> <span class="s2">&quot;*.h&quot;</span><span class="o">|</span><span class="n">xargs</span> <span class="n">grep</span> <span class="o">-</span><span class="n">rn</span> <span class="s2">&quot;xxxx&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h2>baf串有没有拼错<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h2>
<p>拼baf串时注意是否有拼错，可以在ultraedit中选中大括号，用ctrl+b匹配</p>
</div>
<div class="section" id="id7">
<h2>产品订购变更<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h2>
<p>日志所报错误:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">BMS</span><span class="o">-</span><span class="mi">2002</span> <span class="n">BMS</span>  <span class="n">bad</span> <span class="n">argument</span> <span class="c1">#2 to &#39;format&#39; (string expected, got nil)</span>
<span class="n">File</span><span class="p">:</span> <span class="n">bmsRule</span><span class="o">.</span><span class="n">cpp</span><span class="p">,</span> <span class="n">Line</span><span class="c1">#: 78, Compiled DateTime: 14:23:41 Jun 20 20</span>
</pre></div>
</div>
<p>这个错误是很有可能由于用户没有主产品，可以看下表中记录。这种错误基本是在营业规则校验是发生，需要找到对应的规则公式。临时的解决方法是更换BUSI_CODE，遇到时可以改一下再试试。</p>
<p>还有后台开发还有好几位，一般如果是哪位开发的，你让他查会快些，但如果他没空，你可以试着让别人帮你看看。</p>
</div>
<div class="section" id="id8">
<h2>以下是给后台开发的<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h2>
<p>编译时报:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s2">&quot;bmsAux.cpp&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mf">6729.33</span><span class="p">:</span> <span class="mi">1540</span><span class="o">-</span><span class="mi">0063</span> <span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="n">The</span> <span class="n">text</span> <span class="s2">&quot;res&quot;</span> <span class="ow">is</span> <span class="n">unexpected</span><span class="o">.</span>
</pre></div>
</div>
<p>通常是上一行代码没有加”;”，分号没有加导致。</p>
<p>编译时报:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">BMS</span><span class="o">-</span><span class="mi">2001</span> <span class="n">OSS</span> <span class="n">Variant</span> <span class="nb">type</span> <span class="n">cast</span> <span class="n">error</span>
</pre></div>
</div>
<p>通常是类型转换错误，多加些打印语句，就可以定位到相应代码。
有可能是你的 <code class="docutils literal"><span class="pre">stat&lt;&lt;value</span></code> 之类的语句顺序写错，导致运行时传入的值类型不匹配。</p>
<p>报baf找不到：那要看下自己的baf有没有拼错，比如Fee_Einvoice_Print_Receipt {拼成Fee_Einvoice_Print_Receipt{，
把大括号和baf连到一起了，那自然在内存中找不到该baf。
或者有没有注册（你知道的），或者头文件有没有加声明。或者bms.tcl/acct.tcl中有没有吧baf所在的lib库load进去。
或者编译链接时有没有漏掉什么。</p>
<p>还有一种感觉应该落表的，但是没落表，感觉应该搜到的，没搜到。看一下语句的入参问题。
后台写:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">stat</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;insert into ucs_subscription where ucs_subscription_id = :f2 and credit_value = :f1&quot;</span><span class="p">)</span>
<span class="n">stat</span><span class="o">&lt;&lt;</span><span class="n">credit_value</span><span class="p">;</span>
<span class="n">stat</span><span class="o">&lt;&lt;</span><span class="n">subs_id</span><span class="p">;</span>
</pre></div>
</div>
<p>以上语句问题在于以为入参和：:f1 :f2对应，其实不是，只跟语句中的位置有关，写在前面的要先入参，后面的后入。</p>
<p>AIX上，linux没试过，不过基本一样（最好自己再验证一下）
int32   可以表示10进制数有效9位长度。
int64   可以表示10进制数有效19位长度。</p>
<p>后台开发尽量用int32，或int64，
double之类的不小心容易出错。比如if(0.000001 == 0)很可能是成立的。</p>
<p>对于:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">int64</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">99999999999</span><span class="p">;</span>
<span class="n">int64</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">9999999</span><span class="o">*</span><span class="mi">10000</span><span class="o">+</span><span class="mi">100</span><span class="p">;</span>
</pre></div>
</div>
<p>最后显示a,b都不是所想的值得问题，是因为右侧的值（我猜测）在编译阶段就当做正常的数处理，也就是int。这时候的结果已经溢出，所以赋给左侧时得到的不是想要的值。编译时通常会报一个out of range警告。</p>
<p>改正方法是:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">int64</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">9999999</span><span class="p">;</span>
<span class="n">a</span> <span class="o">*=</span> <span class="mi">10000</span><span class="o">+</span><span class="mi">100</span><span class="p">;</span>
</pre></div>
</div>
<p>这样应该就没问题了。
或者 int64 a = 99999999999L;这样写，没试过，可能行。</p>
<p>有时候报插表出错，很可能是某个值不对，那就加cout语句，把值都打印出来，看看那个不对。这样基本能定位到。</p>
<p>对于 类似 <code class="docutils literal"><span class="pre">basic_string</span> <span class="pre">Construct</span></code> 这种字样的错误，很可能是初始化string对象时出错，比如:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>string str1=0；
string str2(NULL);
string str3(0);
</pre></div>
</div>
<p>这3种都是错误的，正确的写法是:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">string</span> <span class="n">str4</span><span class="p">;</span>
<span class="n">string</span> <span class="n">str5</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>
<span class="n">string</span> <span class="n">str6</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">);</span>
<span class="n">string</span> <span class="n">str7</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span><span class="p">;</span>
<span class="n">string</span> <span class="n">str8</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h2>网络方面的问题<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h2>
<p>可能遇到字节序的问题，网络字节序是BigEndian，PowerPc处理器是BigEndian，x86系列是LittleEndian，
程序在从AIX迁移到linux主机时，如果不是用跨平台的框架写的就很可能遇到字节序的问题。这个时候把收到的
内容以16进制方式打印出来，对比下，可以判断是不是这类问题。</p>
<p>另外程序迁移时还有可能遇到字符集转换的问题，比如使用了iconv库，需要注意。</p>
</div>
<div class="section" id="shell">
<h2>shell脚本的问题<a class="headerlink" href="#shell" title="永久链接至标题">¶</a></h2>
<p>脚本不能执行，请检查是否加了可执行权限，编码是否是unix格式的</p>
<p>自己测试时跑没问题，但配成crontab或实时运行时却没有正确结果，那看一下别的crontab怎么配置的，基本上是没有加上
. .profile或. bash_profile。这是由于这几个文件在窗口前这个会话是有效的，当在后台跑时，对于程序来说这些文件中的
环境变量没有生效。</p>
</div>
<div class="section" id="core12">
<h2>core的原因1、2<a class="headerlink" href="#core12" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li>原因1</li>
</ul>
<p>对于core文件中有~destructor析构之类的报错：
需要查看对应类中是否有数组指针，对于
delete [] p;之类的core，很可能是在代码运行中把数组前后一部分内存给覆盖了。导致delete时需要的有关该数组的信息没了。</p>
<ul class="simple">
<li>原因2</li>
</ul>
<p>另外一种是显式调用析构函数，例如:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
        <span class="n">bmsTimer</span> <span class="n">mytimer</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">);</span>
        <span class="o">/*</span><span class="n">代码</span><span class="o">*/</span>
        <span class="n">mytimer</span><span class="o">.~</span><span class="n">bmsTimer</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>bmsTimer中有指向构造时向系统申请的堆空间，显式析构时会释放一次，但编译器会在代码块结束时隐式调用析构函数一次，导致重复析构。
所以对于显式调用析构，一定要小心，而且这种写法基本是错的。
如果必须要在某处析构，可以修改这个对象放的作用域:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
        <span class="n">bmsTimer</span> <span class="n">mytimer</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">);</span>
        <span class="o">/*</span><span class="n">代码</span><span class="o">*/</span>
        <span class="o">//</span><span class="n">mytimer</span><span class="o">.~</span><span class="n">bmsTimer</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="core3456">
<h2>core的原因3、4、5、6<a class="headerlink" href="#core3456" title="永久链接至标题">¶</a></h2>
<ul>
<li><dl class="first docutils">
<dt>原因3:</dt>
<dd><p class="first last">空指针解引用。代码里编写的时候没有判断函数返回指针是否为空，或运行过程中代码可能赋值指针为空。对于aix，这个基本不报错，但到了linux上是就直接core了。</p>
</dd>
</dl>
</li>
<li><p class="first">原因4:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>strcpy(dst,src)如果是数组拷贝，越界了也会core
</pre></div>
</div>
</li>
<li><dl class="first docutils">
<dt>原因5:</dt>
<dd><p class="first last">使用ACE的日志，相关路径中的目录不存在，分析core文件是见到ACE、Log字样时可以考虑建一下相关目录(如果不存在的话)。或许就解决了。</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>原因6:</dt>
<dd><p class="first last">头文件中的类定义有变化，但相关的cpp文件没有重编，有可能导致程序运行core掉。解决办法是重编相关目录，直接make clean&amp;&amp;make</p>
</dd>
</dl>
</li>
</ul>
<p>bms.tcl加载时报coredump
用gdb查看core文件，发现在库的初始化函数的第一行代码就挂了，最后回退代码，在一个文件一个文件更新编译，发现是某个库有问题。
猜测出现这种现象，是生成的某个库有问题，导致链接他的库都有问题。但是aix上没有，linux上有。</p>
<dl class="docutils">
<dt>解决问题的办法主要有：</dt>
<dd><ul class="first last simple">
<li>printf、cout</li>
<li>打日志（针对daemon之类的守护进程）</li>
<li>core文件分析</li>
<li>此外就是基础知识与经验与对代码、业务的熟悉程度了，多种手段结合。</li>
</ul>
</dd>
</dl>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="gdbAnddbx.html" class="btn btn-neutral float-right" title="gdb与dbx使用简介" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tools.html" class="btn btn-neutral" title="工具推荐" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; 版权所有 2017, zyj.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>